{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar React = require(\"react\");\n\nvar react_draggable_1 = require(\"react-draggable\");\n\nvar __1 = require(\"../../\");\n\nvar CanvasContext_1 = require(\"./CanvasContext\");\n\nvar CanvasWrapper =\n/** @class */\nfunction (_super) {\n  __extends(CanvasWrapper, _super);\n\n  function CanvasWrapper() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      width: 0,\n      height: 0,\n      offsetX: 0,\n      offsetY: 0\n    };\n    _this.ref = React.createRef();\n\n    _this.updateSize = function () {\n      var el = _this.ref.current;\n\n      if (el) {\n        var rect = el.getBoundingClientRect();\n\n        if (el.offsetWidth !== _this.state.width || el.offsetHeight !== _this.state.height) {\n          _this.setState({\n            width: el.offsetWidth,\n            height: el.offsetHeight\n          });\n\n          _this.props.onSizeChange(el.offsetWidth, el.offsetHeight);\n        }\n\n        if (rect.left !== _this.state.offsetX || rect.top !== _this.state.offsetY) {\n          _this.setState({\n            offsetX: rect.left,\n            offsetY: rect.top\n          });\n        }\n      }\n    };\n\n    return _this;\n  }\n\n  CanvasWrapper.prototype.componentDidMount = function () {\n    this.updateSize();\n\n    if (this.ref.current) {\n      if (window.ResizeObserver) {\n        var ro = new window.ResizeObserver(this.updateSize);\n        ro.observe(this.ref.current);\n      } else {\n        window.addEventListener('resize', this.updateSize);\n      }\n\n      window.addEventListener('scroll', this.updateSize);\n    }\n  };\n\n  CanvasWrapper.prototype.componentDidUpdate = function () {\n    this.updateSize();\n  };\n\n  CanvasWrapper.prototype.componentWillUnmount = function () {\n    window.removeEventListener('resize', this.updateSize);\n    window.removeEventListener('scroll', this.updateSize);\n  };\n\n  CanvasWrapper.prototype.render = function () {\n    var _a = this.props,\n        config = _a.config,\n        ComponentInner = _a.ComponentInner,\n        ComponentOuter = _a.ComponentOuter,\n        position = _a.position,\n        onDragCanvas = _a.onDragCanvas,\n        children = _a.children,\n        onCanvasClick = _a.onCanvasClick,\n        onDeleteKey = _a.onDeleteKey,\n        onCanvasDrop = _a.onCanvasDrop;\n    var _b = this.state,\n        offsetX = _b.offsetX,\n        offsetY = _b.offsetY;\n    return React.createElement(CanvasContext_1.default.Provider, {\n      value: {\n        offsetX: this.state.offsetX,\n        offsetY: this.state.offsetY\n      }\n    }, React.createElement(ComponentOuter, {\n      config: config,\n      ref: this.ref\n    }, React.createElement(react_draggable_1.default, {\n      axis: \"both\",\n      position: position,\n      grid: [1, 1],\n      onDrag: function (event, data) {\n        return onDragCanvas({\n          config: config,\n          event: event,\n          data: data\n        });\n      },\n      disabled: config.readonly\n    }, React.createElement(ComponentInner, {\n      config: config,\n      children: children,\n      onClick: onCanvasClick,\n      tabIndex: 0,\n      onKeyDown: function (e) {\n        // delete or backspace keys\n        if (e.keyCode === 46 || e.keyCode === 8) {\n          onDeleteKey({\n            config: config\n          });\n        }\n      },\n      onDrop: function (e) {\n        var data = JSON.parse(e.dataTransfer.getData(__1.REACT_FLOW_CHART));\n\n        if (data) {\n          onCanvasDrop({\n            data: data,\n            position: {\n              x: e.clientX - (position.x + offsetX),\n              y: e.clientY - (position.y + offsetY)\n            }\n          });\n        }\n      },\n      onDragOver: function (e) {\n        return e.preventDefault();\n      }\n    }))));\n  };\n\n  return CanvasWrapper;\n}(React.Component);\n\nexports.CanvasWrapper = CanvasWrapper;","map":{"version":3,"sources":["../../../../src/components/Canvas/Canvas.wrapper.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = require(\"react\");\nvar react_draggable_1 = require(\"react-draggable\");\nvar __1 = require(\"../../\");\nvar CanvasContext_1 = require(\"./CanvasContext\");\nvar CanvasWrapper = /** @class */ (function (_super) {\n    __extends(CanvasWrapper, _super);\n    function CanvasWrapper() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.state = {\n            width: 0,\n            height: 0,\n            offsetX: 0,\n            offsetY: 0,\n        };\n        _this.ref = React.createRef();\n        _this.updateSize = function () {\n            var el = _this.ref.current;\n            if (el) {\n                var rect = el.getBoundingClientRect();\n                if (el.offsetWidth !== _this.state.width || el.offsetHeight !== _this.state.height) {\n                    _this.setState({ width: el.offsetWidth, height: el.offsetHeight });\n                    _this.props.onSizeChange(el.offsetWidth, el.offsetHeight);\n                }\n                if (rect.left !== _this.state.offsetX || rect.top !== _this.state.offsetY) {\n                    _this.setState({ offsetX: rect.left, offsetY: rect.top });\n                }\n            }\n        };\n        return _this;\n    }\n    CanvasWrapper.prototype.componentDidMount = function () {\n        this.updateSize();\n        if (this.ref.current) {\n            if (window.ResizeObserver) {\n                var ro = new window.ResizeObserver(this.updateSize);\n                ro.observe(this.ref.current);\n            }\n            else {\n                window.addEventListener('resize', this.updateSize);\n            }\n            window.addEventListener('scroll', this.updateSize);\n        }\n    };\n    CanvasWrapper.prototype.componentDidUpdate = function () {\n        this.updateSize();\n    };\n    CanvasWrapper.prototype.componentWillUnmount = function () {\n        window.removeEventListener('resize', this.updateSize);\n        window.removeEventListener('scroll', this.updateSize);\n    };\n    CanvasWrapper.prototype.render = function () {\n        var _a = this.props, config = _a.config, ComponentInner = _a.ComponentInner, ComponentOuter = _a.ComponentOuter, position = _a.position, onDragCanvas = _a.onDragCanvas, children = _a.children, onCanvasClick = _a.onCanvasClick, onDeleteKey = _a.onDeleteKey, onCanvasDrop = _a.onCanvasDrop;\n        var _b = this.state, offsetX = _b.offsetX, offsetY = _b.offsetY;\n        return (React.createElement(CanvasContext_1.default.Provider, { value: { offsetX: this.state.offsetX, offsetY: this.state.offsetY } },\n            React.createElement(ComponentOuter, { config: config, ref: this.ref },\n                React.createElement(react_draggable_1.default, { axis: \"both\", position: position, grid: [1, 1], onDrag: function (event, data) { return onDragCanvas({ config: config, event: event, data: data }); }, disabled: config.readonly },\n                    React.createElement(ComponentInner, { config: config, children: children, onClick: onCanvasClick, tabIndex: 0, onKeyDown: function (e) {\n                            // delete or backspace keys\n                            if (e.keyCode === 46 || e.keyCode === 8) {\n                                onDeleteKey({ config: config });\n                            }\n                        }, onDrop: function (e) {\n                            var data = JSON.parse(e.dataTransfer.getData(__1.REACT_FLOW_CHART));\n                            if (data) {\n                                onCanvasDrop({ data: data, position: {\n                                        x: e.clientX - (position.x + offsetX),\n                                        y: e.clientY - (position.y + offsetY),\n                                    } });\n                            }\n                        }, onDragOver: function (e) { return e.preventDefault(); } })))));\n    };\n    return CanvasWrapper;\n}(React.Component));\nexports.CanvasWrapper = CanvasWrapper;\n//# sourceMappingURL=Canvas.wrapper.js.map"]},"metadata":{},"sourceType":"script"}