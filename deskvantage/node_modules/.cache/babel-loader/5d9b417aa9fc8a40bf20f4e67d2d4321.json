{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar React = require(\"react\");\n\nvar ReactDOM = require(\"react-dom\");\n\nvar react_draggable_1 = require(\"react-draggable\");\n\nvar react_resize_observer_1 = require(\"react-resize-observer\");\n\nvar __1 = require(\"../../\");\n\nvar utils_1 = require(\"../../utils\");\n\nvar Node_default_1 = require(\"./Node.default\");\n\nexports.NodeWrapper = function (_a) {\n  var config = _a.config,\n      node = _a.node,\n      onDragNode = _a.onDragNode,\n      onNodeClick = _a.onNodeClick,\n      isSelected = _a.isSelected,\n      _b = _a.Component,\n      Component = _b === void 0 ? Node_default_1.NodeDefault : _b,\n      onNodeSizeChange = _a.onNodeSizeChange,\n      NodeInner = _a.NodeInner,\n      Ports = _a.Ports,\n      Port = _a.Port,\n      offset = _a.offset,\n      selected = _a.selected,\n      selectedLink = _a.selectedLink,\n      hovered = _a.hovered,\n      hoveredLink = _a.hoveredLink,\n      onPortPositionChange = _a.onPortPositionChange,\n      onLinkStart = _a.onLinkStart,\n      onLinkMove = _a.onLinkMove,\n      onLinkComplete = _a.onLinkComplete,\n      onLinkCancel = _a.onLinkCancel;\n\n  var _c = React.useState({\n    width: 0,\n    height: 0\n  }),\n      size = _c[0],\n      setSize = _c[1];\n\n  var isDragging = React.useRef(false);\n  var onStart = React.useCallback(function (e) {\n    // Stop propagation so the canvas does not move\n    e.stopPropagation();\n    isDragging.current = false;\n  }, []);\n  var onDrag = React.useCallback(function (event, data) {\n    isDragging.current = true;\n    onDragNode({\n      config: config,\n      event: event,\n      data: data,\n      id: node.id\n    });\n  }, [onDragNode, config, node.id]);\n  var onClick = React.useCallback(function (e) {\n    if (!config.readonly) {\n      e.stopPropagation();\n\n      if (!isDragging.current) {\n        onNodeClick({\n          config: config,\n          nodeId: node.id\n        });\n      }\n    }\n  }, [config, node.id]);\n  var compRef = React.useRef(null); // TODO: probably should add an observer to track node component size changes\n\n  React.useLayoutEffect(function () {\n    var el = ReactDOM.findDOMNode(compRef.current);\n\n    if (el) {\n      if ((node.size && node.size.width) !== el.offsetWidth || (node.size && node.size.height) !== el.offsetHeight) {\n        var newSize = {\n          width: el.offsetWidth,\n          height: el.offsetHeight\n        };\n        setSize(newSize);\n        onNodeSizeChange({\n          config: config,\n          nodeId: node.id,\n          size: newSize\n        });\n      }\n    }\n  }, [node, compRef.current, size.width, size.height]);\n  var children = React.createElement(React.Fragment, null, React.createElement(react_resize_observer_1.default, {\n    onResize: function (rect) {\n      var newSize = {\n        width: rect.width,\n        height: rect.height\n      };\n      setSize(newSize);\n    }\n  }), React.createElement(NodeInner, {\n    node: node,\n    config: config\n  }), React.createElement(Ports, {\n    config: config\n  }, Object.keys(node.ports).map(function (portId) {\n    return React.createElement(__1.PortWrapper, {\n      config: config,\n      key: portId,\n      offset: offset,\n      selected: selected,\n      selectedLink: selectedLink,\n      hoveredLink: hoveredLink,\n      hovered: hovered,\n      node: node,\n      port: node.ports[portId],\n      Component: Port,\n      onPortPositionChange: onPortPositionChange,\n      onLinkStart: config.readonly ? utils_1.noop : onLinkStart,\n      onLinkMove: config.readonly ? utils_1.noop : onLinkMove,\n      onLinkComplete: onLinkComplete,\n      onLinkCancel: onLinkCancel\n    });\n  })));\n  return React.createElement(react_draggable_1.default, {\n    bounds: \"parent\",\n    axis: \"both\",\n    position: node.position,\n    grid: [1, 1],\n    onStart: onStart,\n    onDrag: onDrag,\n    disabled: config.readonly\n  }, React.createElement(Component, {\n    config: config,\n    ref: compRef,\n    children: children,\n    onClick: onClick,\n    isSelected: isSelected,\n    node: node\n  }));\n};","map":{"version":3,"sources":["../../../../src/components/Node/Node.wrapper.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = require(\"react\");\nvar ReactDOM = require(\"react-dom\");\nvar react_draggable_1 = require(\"react-draggable\");\nvar react_resize_observer_1 = require(\"react-resize-observer\");\nvar __1 = require(\"../../\");\nvar utils_1 = require(\"../../utils\");\nvar Node_default_1 = require(\"./Node.default\");\nexports.NodeWrapper = function (_a) {\n    var config = _a.config, node = _a.node, onDragNode = _a.onDragNode, onNodeClick = _a.onNodeClick, isSelected = _a.isSelected, _b = _a.Component, Component = _b === void 0 ? Node_default_1.NodeDefault : _b, onNodeSizeChange = _a.onNodeSizeChange, NodeInner = _a.NodeInner, Ports = _a.Ports, Port = _a.Port, offset = _a.offset, selected = _a.selected, selectedLink = _a.selectedLink, hovered = _a.hovered, hoveredLink = _a.hoveredLink, onPortPositionChange = _a.onPortPositionChange, onLinkStart = _a.onLinkStart, onLinkMove = _a.onLinkMove, onLinkComplete = _a.onLinkComplete, onLinkCancel = _a.onLinkCancel;\n    var _c = React.useState({ width: 0, height: 0 }), size = _c[0], setSize = _c[1];\n    var isDragging = React.useRef(false);\n    var onStart = React.useCallback(function (e) {\n        // Stop propagation so the canvas does not move\n        e.stopPropagation();\n        isDragging.current = false;\n    }, []);\n    var onDrag = React.useCallback(function (event, data) {\n        isDragging.current = true;\n        onDragNode({ config: config, event: event, data: data, id: node.id });\n    }, [onDragNode, config, node.id]);\n    var onClick = React.useCallback(function (e) {\n        if (!config.readonly) {\n            e.stopPropagation();\n            if (!isDragging.current) {\n                onNodeClick({ config: config, nodeId: node.id });\n            }\n        }\n    }, [config, node.id]);\n    var compRef = React.useRef(null);\n    // TODO: probably should add an observer to track node component size changes\n    React.useLayoutEffect(function () {\n        var el = ReactDOM.findDOMNode(compRef.current);\n        if (el) {\n            if ((node.size && node.size.width) !== el.offsetWidth ||\n                (node.size && node.size.height) !== el.offsetHeight) {\n                var newSize = { width: el.offsetWidth, height: el.offsetHeight };\n                setSize(newSize);\n                onNodeSizeChange({ config: config, nodeId: node.id, size: newSize });\n            }\n        }\n    }, [node, compRef.current, size.width, size.height]);\n    var children = (React.createElement(React.Fragment, null,\n        React.createElement(react_resize_observer_1.default, { onResize: function (rect) {\n                var newSize = { width: rect.width, height: rect.height };\n                setSize(newSize);\n            } }),\n        React.createElement(NodeInner, { node: node, config: config }),\n        React.createElement(Ports, { config: config }, Object.keys(node.ports).map(function (portId) { return (React.createElement(__1.PortWrapper, { config: config, key: portId, offset: offset, selected: selected, selectedLink: selectedLink, hoveredLink: hoveredLink, hovered: hovered, node: node, port: node.ports[portId], Component: Port, onPortPositionChange: onPortPositionChange, onLinkStart: config.readonly ? utils_1.noop : onLinkStart, onLinkMove: config.readonly ? utils_1.noop : onLinkMove, onLinkComplete: onLinkComplete, onLinkCancel: onLinkCancel })); }))));\n    return (React.createElement(react_draggable_1.default, { bounds: \"parent\", axis: \"both\", position: node.position, grid: [1, 1], onStart: onStart, onDrag: onDrag, disabled: config.readonly },\n        React.createElement(Component, { config: config, ref: compRef, children: children, onClick: onClick, isSelected: isSelected, node: node })));\n};\n//# sourceMappingURL=Node.wrapper.js.map"]},"metadata":{},"sourceType":"script"}